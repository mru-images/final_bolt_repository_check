"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./components/AuthWrapper.tsx":
/*!************************************!*\
  !*** ./components/AuthWrapper.tsx ***!
  \************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _hooks_useAuth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/hooks/useAuth */ \"(app-pages-browser)/./hooks/useAuth.ts\");\n/* harmony import */ var _LoginPage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./LoginPage */ \"(app-pages-browser)/./components/LoginPage.tsx\");\n\nvar _s = $RefreshSig$();\n\n\n\nconst AuthWrapper = (param)=>{\n    let { children } = param;\n    _s();\n    const { user, loading } = (0,_hooks_useAuth__WEBPACK_IMPORTED_MODULE_2__.useAuth)();\n    if (loading) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"min-h-screen bg-gray-900 flex items-center justify-center\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"text-center\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"text-white text-2xl\",\n                            children: \"♪\"\n                        }, void 0, false, {\n                            fileName: \"/home/project/components/AuthWrapper.tsx\",\n                            lineNumber: 18,\n                            columnNumber: 13\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"/home/project/components/AuthWrapper.tsx\",\n                        lineNumber: 17,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-white text-lg\",\n                        children: \"Authenticating...\"\n                    }, void 0, false, {\n                        fileName: \"/home/project/components/AuthWrapper.tsx\",\n                        lineNumber: 20,\n                        columnNumber: 11\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/project/components/AuthWrapper.tsx\",\n                lineNumber: 16,\n                columnNumber: 9\n            }, undefined)\n        }, void 0, false, {\n            fileName: \"/home/project/components/AuthWrapper.tsx\",\n            lineNumber: 15,\n            columnNumber: 7\n        }, undefined);\n    }\n    if (!user) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_LoginPage__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {}, void 0, false, {\n            fileName: \"/home/project/components/AuthWrapper.tsx\",\n            lineNumber: 27,\n            columnNumber: 12\n        }, undefined);\n    }\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: children\n    }, void 0, false);\n};\n_s(AuthWrapper, \"EmJkapf7qiLC5Br5eCoEq4veZes=\", false, function() {\n    return [\n        _hooks_useAuth__WEBPACK_IMPORTED_MODULE_2__.useAuth\n    ];\n});\n_c = AuthWrapper;\n/* harmony default export */ __webpack_exports__[\"default\"] = (AuthWrapper);\nvar _c;\n$RefreshReg$(_c, \"AuthWrapper\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2NvbXBvbmVudHMvQXV0aFdyYXBwZXIudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXlCO0FBQ2dCO0FBQ047QUFPbkMsTUFBTUcsY0FBMEM7UUFBQyxFQUFFQyxRQUFRLEVBQUU7O0lBQzNELE1BQU0sRUFBRUMsSUFBSSxFQUFFQyxPQUFPLEVBQUUsR0FBR0wsdURBQU9BO0lBRWpDLElBQUlLLFNBQVM7UUFDWCxxQkFDRSw4REFBQ0M7WUFBSUMsV0FBVTtzQkFDYiw0RUFBQ0Q7Z0JBQUlDLFdBQVU7O2tDQUNiLDhEQUFDRDt3QkFBSUMsV0FBVTtrQ0FDYiw0RUFBQ0Q7NEJBQUlDLFdBQVU7c0NBQXNCOzs7Ozs7Ozs7OztrQ0FFdkMsOERBQUNDO3dCQUFFRCxXQUFVO2tDQUFxQjs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFJMUM7SUFFQSxJQUFJLENBQUNILE1BQU07UUFDVCxxQkFBTyw4REFBQ0gsa0RBQVNBOzs7OztJQUNuQjtJQUVBLHFCQUFPO2tCQUFHRTs7QUFDWjtHQXJCTUQ7O1FBQ3NCRixtREFBT0E7OztLQUQ3QkU7QUF1Qk4sK0RBQWVBLFdBQVdBLEVBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vY29tcG9uZW50cy9BdXRoV3JhcHBlci50c3g/MGU0NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnQC9ob29rcy91c2VBdXRoJ1xuaW1wb3J0IExvZ2luUGFnZSBmcm9tICcuL0xvZ2luUGFnZSdcbmltcG9ydCBMb2FkaW5nU3Bpbm5lciBmcm9tICcuL0xvYWRpbmdTcGlubmVyJ1xuXG5pbnRlcmZhY2UgQXV0aFdyYXBwZXJQcm9wcyB7XG4gIGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGVcbn1cblxuY29uc3QgQXV0aFdyYXBwZXI6IFJlYWN0LkZDPEF1dGhXcmFwcGVyUHJvcHM+ID0gKHsgY2hpbGRyZW4gfSkgPT4ge1xuICBjb25zdCB7IHVzZXIsIGxvYWRpbmcgfSA9IHVzZUF1dGgoKVxuXG4gIGlmIChsb2FkaW5nKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWluLWgtc2NyZWVuIGJnLWdyYXktOTAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctMTYgaC0xNiBiZy1ncmFkaWVudC10by1iciBmcm9tLXB1cnBsZS01MDAgdG8tcGluay01MDAgcm91bmRlZC1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIG14LWF1dG8gbWItNCBhbmltYXRlLXB1bHNlXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtd2hpdGUgdGV4dC0yeGxcIj7imao8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlIHRleHQtbGdcIj5BdXRoZW50aWNhdGluZy4uLjwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApXG4gIH1cblxuICBpZiAoIXVzZXIpIHtcbiAgICByZXR1cm4gPExvZ2luUGFnZSAvPlxuICB9XG5cbiAgcmV0dXJuIDw+e2NoaWxkcmVufTwvPlxufVxuXG5leHBvcnQgZGVmYXVsdCBBdXRoV3JhcHBlciJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZUF1dGgiLCJMb2dpblBhZ2UiLCJBdXRoV3JhcHBlciIsImNoaWxkcmVuIiwidXNlciIsImxvYWRpbmciLCJkaXYiLCJjbGFzc05hbWUiLCJwIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./components/AuthWrapper.tsx\n"));

/***/ }),

/***/ "(app-pages-browser)/./hooks/useSupabaseData.ts":
/*!**********************************!*\
  !*** ./hooks/useSupabaseData.ts ***!
  \**********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useSupabaseData: function() { return /* binding */ useSupabaseData; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase */ \"(app-pages-browser)/./lib/supabase.ts\");\n\n\nfunction useSupabaseData(user) {\n    const [songs, setSongs] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [playlists, setPlaylists] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [likedSongs, setLikedSongs] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(new Set());\n    const [lastPlayedSong, setLastPlayedSong] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [currentSongStartTime, setCurrentSongStartTime] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const currentSongRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    // Convert database song to UI song format\n    const convertDatabaseSong = function(dbSong) {\n        let isLiked = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;\n        return {\n            file_id: dbSong.file_id,\n            img_id: dbSong.img_id,\n            name: dbSong.name,\n            artist: dbSong.artist,\n            language: dbSong.language,\n            tags: dbSong.tags,\n            views: dbSong.views,\n            likes: dbSong.likes,\n            id: dbSong.file_id.toString(),\n            image: \"https://images.pexels.com/photos/\".concat(dbSong.img_id, \"/pexels-photo-\").concat(dbSong.img_id, \".jpeg?auto=compress&cs=tinysrgb&w=300\"),\n            isLiked\n        };\n    };\n    // Fetch all songs\n    const fetchSongs = async ()=>{\n        if (!user) {\n            setSongs([]);\n            return;\n        }\n        try {\n            const { data: songsData, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"songs\").select(\"*\").order(\"views\", {\n                ascending: false\n            });\n            if (error) throw error;\n            let userLikedSongs = new Set();\n            const { data: likedData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"liked_songs\").select(\"song_id\").eq(\"user_id\", user.id);\n            if (likedData) {\n                userLikedSongs = new Set(likedData.map((item)=>item.song_id));\n                setLikedSongs(userLikedSongs);\n            }\n            const convertedSongs = (songsData === null || songsData === void 0 ? void 0 : songsData.map((song)=>convertDatabaseSong(song, userLikedSongs.has(song.file_id)))) || [];\n            const sortedSongs = [\n                ...convertedSongs\n            ].sort((a, b)=>{\n                const aScore = a.views + a.likes;\n                const bScore = b.views + b.likes;\n                return bScore - aScore;\n            });\n            setSongs(sortedSongs);\n            const { data: userData } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"users\").select(\"last_song_file_id\").eq(\"id\", user.id).single();\n            if (userData === null || userData === void 0 ? void 0 : userData.last_song_file_id) {\n                const lastSong = convertedSongs.find((song)=>song.file_id === userData.last_song_file_id);\n                if (lastSong) {\n                    setLastPlayedSong(lastSong);\n                }\n            }\n        } catch (error) {\n            console.error(\"Error fetching songs:\", error);\n            setSongs([]) // Set empty array on error\n            ;\n        }\n    };\n    // Fetch user playlists\n    const fetchPlaylists = async ()=>{\n        if (!user) {\n            setPlaylists([]);\n            return;\n        }\n        try {\n            const { data: playlistsData, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"playlists\").select(\"\\n          id,\\n          name,\\n          playlist_songs (\\n            songs (*)\\n          )\\n        \").eq(\"user_id\", user.id);\n            if (error) throw error;\n            const convertedPlaylists = (playlistsData === null || playlistsData === void 0 ? void 0 : playlistsData.map((playlist)=>{\n                var _playlist_playlist_songs, _playlistSongs_;\n                const playlistSongs = ((_playlist_playlist_songs = playlist.playlist_songs) === null || _playlist_playlist_songs === void 0 ? void 0 : _playlist_playlist_songs.map((ps)=>convertDatabaseSong(ps.songs, likedSongs.has(ps.songs.file_id)))) || [];\n                return {\n                    id: playlist.id.toString(),\n                    name: playlist.name,\n                    songCount: playlistSongs.length,\n                    image: ((_playlistSongs_ = playlistSongs[0]) === null || _playlistSongs_ === void 0 ? void 0 : _playlistSongs_.image) || \"https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg?auto=compress&cs=tinysrgb&w=300\",\n                    songs: playlistSongs\n                };\n            })) || [];\n            setPlaylists(convertedPlaylists);\n        } catch (error) {\n            console.error(\"Error fetching playlists:\", error);\n        }\n    };\n    // Toggle like song\n    const toggleLike = async (songId)=>{\n        if (!user) return;\n        const songFileId = parseInt(songId);\n        const isCurrentlyLiked = likedSongs.has(songFileId);\n        try {\n            if (isCurrentlyLiked) {\n                // Remove from liked_songs\n                const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"liked_songs\").delete().eq(\"user_id\", user.id).eq(\"song_id\", songFileId);\n                if (error) throw error;\n                // Decrement likes\n                await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.rpc(\"decrement_song_likes\", {\n                    song_file_id: songFileId\n                });\n                setLikedSongs((prev)=>{\n                    const newSet = new Set(prev);\n                    newSet.delete(songFileId);\n                    return newSet;\n                });\n            } else {\n                // Add to liked_songs\n                const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"liked_songs\").insert({\n                    user_id: user.id,\n                    song_id: songFileId\n                });\n                if (error) throw error;\n                // Increment likes\n                await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.rpc(\"increment_song_likes\", {\n                    song_file_id: songFileId\n                });\n                setLikedSongs((prev)=>new Set(prev).add(songFileId));\n            }\n            // Update songs state\n            // Update songs state\n            setSongs((prevSongs)=>prevSongs.map((song)=>song.id === songId ? {\n                        ...song,\n                        isLiked: !isCurrentlyLiked,\n                        likes: song.likes + (isCurrentlyLiked ? -1 : 1)\n                    } : song));\n            // Update playlists state\n            setPlaylists((prevPlaylists)=>prevPlaylists.map((playlist)=>({\n                        ...playlist,\n                        songs: playlist.songs.map((song)=>song.id === songId ? {\n                                ...song,\n                                isLiked: !isCurrentlyLiked,\n                                likes: song.likes + (isCurrentlyLiked ? -1 : 1)\n                            } : song)\n                    })));\n        } catch (error) {\n            console.error(\"Error toggling like:\", error);\n        }\n    };\n    // Create playlist\n    const createPlaylist = async (name)=>{\n        if (!user) return;\n        try {\n            const { data, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"playlists\").insert({\n                user_id: user.id,\n                name\n            }).select().single();\n            if (error) throw error;\n            const newPlaylist = {\n                id: data.id.toString(),\n                name: data.name,\n                songCount: 0,\n                image: \"https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg?auto=compress&cs=tinysrgb&w=300\",\n                songs: []\n            };\n            setPlaylists((prev)=>[\n                    ...prev,\n                    newPlaylist\n                ]);\n        } catch (error) {\n            console.error(\"Error creating playlist:\", error);\n        }\n    };\n    // Delete playlist\n    const deletePlaylist = async (playlistId)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"playlists\").delete().eq(\"id\", parseInt(playlistId)).eq(\"user_id\", user.id);\n            if (error) throw error;\n            setPlaylists((prev)=>prev.filter((playlist)=>playlist.id !== playlistId));\n        } catch (error) {\n            console.error(\"Error deleting playlist:\", error);\n        }\n    };\n    // Rename playlist\n    const renamePlaylist = async (playlistId, newName)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"playlists\").update({\n                name: newName\n            }).eq(\"id\", parseInt(playlistId)).eq(\"user_id\", user.id);\n            if (error) throw error;\n            setPlaylists((prev)=>prev.map((playlist)=>playlist.id === playlistId ? {\n                        ...playlist,\n                        name: newName\n                    } : playlist));\n        } catch (error) {\n            console.error(\"Error renaming playlist:\", error);\n        }\n    };\n    // Add song to playlist\n    const addSongToPlaylist = async (playlistId, song)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"playlist_songs\").insert({\n                playlist_id: parseInt(playlistId),\n                song_id: song.file_id\n            });\n            if (error) throw error;\n            setPlaylists((prev)=>prev.map((playlist)=>{\n                    if (playlist.id === playlistId) {\n                        const songExists = playlist.songs.some((s)=>s.id === song.id);\n                        if (!songExists) {\n                            var _updatedSongs_;\n                            const updatedSongs = [\n                                ...playlist.songs,\n                                song\n                            ];\n                            return {\n                                ...playlist,\n                                songs: updatedSongs,\n                                songCount: updatedSongs.length,\n                                image: ((_updatedSongs_ = updatedSongs[0]) === null || _updatedSongs_ === void 0 ? void 0 : _updatedSongs_.image) || playlist.image\n                            };\n                        }\n                    }\n                    return playlist;\n                }));\n        } catch (error) {\n            console.error(\"Error adding song to playlist:\", error);\n        }\n    };\n    // Remove song from playlist\n    const removeSongFromPlaylist = async (playlistId, songId)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"playlist_songs\").delete().eq(\"playlist_id\", parseInt(playlistId)).eq(\"song_id\", parseInt(songId));\n            if (error) throw error;\n            setPlaylists((prev)=>prev.map((playlist)=>{\n                    if (playlist.id === playlistId) {\n                        var _updatedSongs_;\n                        const updatedSongs = playlist.songs.filter((song)=>song.id !== songId);\n                        return {\n                            ...playlist,\n                            songs: updatedSongs,\n                            songCount: updatedSongs.length,\n                            image: ((_updatedSongs_ = updatedSongs[0]) === null || _updatedSongs_ === void 0 ? void 0 : _updatedSongs_.image) || \"https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg?auto=compress&cs=tinysrgb&w=300\"\n                        };\n                    }\n                    return playlist;\n                }));\n        } catch (error) {\n            console.error(\"Error removing song from playlist:\", error);\n        }\n    };\n    // Update last song in user profile\n    const updateLastSong = async (songId)=>{\n        if (!user) return;\n        try {\n            const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"users\").update({\n                last_song_file_id: parseInt(songId)\n            }).eq(\"id\", user.id);\n            if (error) throw error;\n        } catch (error) {\n            console.error(\"Error updating last song:\", error);\n        }\n    };\n    // Record listening history with proper time tracking\n    const recordListeningHistory = async (songId)=>{\n        if (!user) return;\n        // If there's a previous song playing, record its listening time\n        if (currentSongRef.current && currentSongStartTime) {\n            const endTime = new Date();\n            const minutesListened = (endTime.getTime() - currentSongStartTime.getTime()) / (1000 * 60);\n            if (minutesListened > 0.1) {\n                try {\n                    const minutes = Math.round(minutesListened * 100) / 100;\n                    const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.rpc(\"upsert_history_minutes\", {\n                        user_uuid: user.id,\n                        song_file_id: parseInt(currentSongRef.current),\n                        minutes: minutes\n                    });\n                    if (error) {\n                        console.error(\"❌ Error recording song history:\", error);\n                    } else {\n                        console.log(\"✅ History updated: +\".concat(minutes, \" mins for song \").concat(currentSongRef.current));\n                    }\n                } catch (error) {\n                    console.error(\"Error recording previous song history:\", error);\n                }\n            }\n        }\n        // Set new song as current\n        currentSongRef.current = songId;\n        setCurrentSongStartTime(new Date());\n        // Update last song in user profile\n        await updateLastSong(songId);\n        try {\n            await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.rpc(\"increment_song_views\", {\n                song_file_id: parseInt(songId)\n            });\n        } catch (error) {\n            console.error(\"Error incrementing song views:\", error);\n        }\n    };\n    // Stop current song tracking (when player is closed)\n    const stopCurrentSongTracking = async ()=>{\n        if (currentSongRef.current && currentSongStartTime && user) {\n            const endTime = new Date();\n            const minutesListened = (endTime.getTime() - currentSongStartTime.getTime()) / (1000 * 60);\n            if (minutesListened > 0.1) {\n                try {\n                    const minutes = Math.round(minutesListened * 100) / 100;\n                    const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.rpc(\"upsert_history_minutes\", {\n                        user_uuid: user.id,\n                        song_file_id: parseInt(currentSongRef.current),\n                        minutes: minutes\n                    });\n                    if (error) {\n                        console.error(\"❌ Error recording song history on stop:\", error);\n                    } else {\n                        console.log(\"\\uD83D\\uDED1 History updated on stop: +\".concat(minutes, \" mins for song \").concat(currentSongRef.current));\n                    }\n                } catch (error) {\n                    console.error(\"Error recording final song history:\", error);\n                }\n            }\n        }\n        currentSongRef.current = null;\n        setCurrentSongStartTime(null);\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        const loadData = async ()=>{\n            setLoading(true);\n            try {\n                await Promise.all([\n                    fetchSongs(),\n                    fetchPlaylists()\n                ]);\n            } catch (error) {\n                console.error(\"Error loading data:\", error);\n            } finally{\n                setLoading(false);\n            }\n        };\n        if (user) {\n            loadData();\n        } else {\n            // Reset data when user logs out\n            setSongs([]);\n            setPlaylists([]);\n            setLikedSongs(new Set());\n            setLastPlayedSong(null);\n            setLoading(false);\n        }\n    }, [\n        user\n    ]);\n    return {\n        songs,\n        playlists,\n        likedSongs: songs.filter((song)=>song.isLiked),\n        lastPlayedSong,\n        loading,\n        toggleLike,\n        createPlaylist,\n        deletePlaylist,\n        renamePlaylist,\n        addSongToPlaylist,\n        removeSongFromPlaylist,\n        recordListeningHistory,\n        stopCurrentSongTracking,\n        refreshData: ()=>{\n            fetchSongs();\n            fetchPlaylists();\n        }\n    };\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2hvb2tzL3VzZVN1cGFiYXNlRGF0YS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQW1EO0FBRXNCO0FBR2xFLFNBQVNJLGdCQUFnQkMsSUFBaUI7SUFDL0MsTUFBTSxDQUFDQyxPQUFPQyxTQUFTLEdBQUdQLCtDQUFRQSxDQUFTLEVBQUU7SUFDN0MsTUFBTSxDQUFDUSxXQUFXQyxhQUFhLEdBQUdULCtDQUFRQSxDQUFhLEVBQUU7SUFDekQsTUFBTSxDQUFDVSxZQUFZQyxjQUFjLEdBQUdYLCtDQUFRQSxDQUFjLElBQUlZO0lBQzlELE1BQU0sQ0FBQ0MsZ0JBQWdCQyxrQkFBa0IsR0FBR2QsK0NBQVFBLENBQWM7SUFDbEUsTUFBTSxDQUFDZSxTQUFTQyxXQUFXLEdBQUdoQiwrQ0FBUUEsQ0FBQztJQUN2QyxNQUFNLENBQUNpQixzQkFBc0JDLHdCQUF3QixHQUFHbEIsK0NBQVFBLENBQWM7SUFDOUUsTUFBTW1CLGlCQUFpQmpCLDZDQUFNQSxDQUFnQjtJQUU3QywwQ0FBMEM7SUFDMUMsTUFBTWtCLHNCQUFzQixTQUFDQztZQUFzQkMsMkVBQW1CO2VBQWlCO1lBQ3JGQyxTQUFTRixPQUFPRSxPQUFPO1lBQ3ZCQyxRQUFRSCxPQUFPRyxNQUFNO1lBQ3JCQyxNQUFNSixPQUFPSSxJQUFJO1lBQ2pCQyxRQUFRTCxPQUFPSyxNQUFNO1lBQ3JCQyxVQUFVTixPQUFPTSxRQUFRO1lBQ3pCQyxNQUFNUCxPQUFPTyxJQUFJO1lBQ2pCQyxPQUFPUixPQUFPUSxLQUFLO1lBQ25CQyxPQUFPVCxPQUFPUyxLQUFLO1lBQ25CQyxJQUFJVixPQUFPRSxPQUFPLENBQUNTLFFBQVE7WUFDM0JDLE9BQU8sb0NBQWtFWixPQUE5QkEsT0FBT0csTUFBTSxFQUFDLGtCQUE4QixPQUFkSCxPQUFPRyxNQUFNLEVBQUM7WUFDdkZGO1FBQ0Y7O0lBRUEsa0JBQWtCO0lBQ2xCLE1BQU1ZLGFBQWE7UUFDakIsSUFBSSxDQUFDN0IsTUFBTTtZQUNURSxTQUFTLEVB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Q3BELEVBQUUsT0FBTzFCLE9BQU87Z0JBQ2R5QixRQUFRekIsS0FBSyxDQUFDLHVCQUF1QkE7WUFDdkMsU0FBVTtnQkFDUnJCLFdBQVc7WUFDYjtRQUNGO1FBRUEsSUFBSVgsTUFBTTtZQUNSOEc7UUFDRixPQUFPO1lBQ0wsZ0NBQWdDO1lBQ2hDNUcsU0FBUyxFQUFFO1lBQ1hFLGFBQWEsRUFBRTtZQUNmRSxjQUFjLElBQUlDO1lBQ2xCRSxrQkFBa0I7WUFDbEJFLFdBQVc7UUFDYjtJQUNGLEdBQUc7UUFBQ1g7S0FBSztJQUVULE9BQU87UUFDTEM7UUFDQUU7UUFDQUUsWUFBWUosTUFBTXFGLE1BQU0sQ0FBQzFDLENBQUFBLE9BQVFBLEtBQUszQixPQUFPO1FBQzdDVDtRQUNBRTtRQUNBeUQ7UUFDQWU7UUFDQUU7UUFDQUc7UUFDQUc7UUFDQU07UUFDQUU7UUFDQVc7UUFDQUksYUFBYTtZQUNYcEY7WUFDQTZCO1FBQ0Y7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL2hvb2tzL3VzZVN1cGFiYXNlRGF0YS50cz9hYmZjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZVJlZiB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgVXNlciB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcbmltcG9ydCB7IHN1cGFiYXNlLCBEYXRhYmFzZVNvbmcsIERhdGFiYXNlUGxheWxpc3QgfSBmcm9tICdAL2xpYi9zdXBhYmFzZSdcbmltcG9ydCB7IFNvbmcsIFBsYXlsaXN0IH0gZnJvbSAnQC90eXBlcydcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVN1cGFiYXNlRGF0YSh1c2VyOiBVc2VyIHwgbnVsbCkge1xuICBjb25zdCBbc29uZ3MsIHNldFNvbmdzXSA9IHVzZVN0YXRlPFNvbmdbXT4oW10pXG4gIGNvbnN0IFtwbGF5bGlzdHMsIHNldFBsYXlsaXN0c10gPSB1c2VTdGF0ZTxQbGF5bGlzdFtdPihbXSlcbiAgY29uc3QgW2xpa2VkU29uZ3MsIHNldExpa2VkU29uZ3NdID0gdXNlU3RhdGU8U2V0PG51bWJlcj4+KG5ldyBTZXQoKSlcbiAgY29uc3QgW2xhc3RQbGF5ZWRTb25nLCBzZXRMYXN0UGxheWVkU29uZ10gPSB1c2VTdGF0ZTxTb25nIHwgbnVsbD4obnVsbClcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IFtjdXJyZW50U29uZ1N0YXJ0VGltZSwgc2V0Q3VycmVudFNvbmdTdGFydFRpbWVdID0gdXNlU3RhdGU8RGF0ZSB8IG51bGw+KG51bGwpXG4gIGNvbnN0IGN1cnJlbnRTb25nUmVmID0gdXNlUmVmPHN0cmluZyB8IG51bGw+KG51bGwpXG5cbiAgLy8gQ29udmVydCBkYXRhYmFzZSBzb25nIHRvIFVJIHNvbmcgZm9ybWF0XG4gIGNvbnN0IGNvbnZlcnREYXRhYmFzZVNvbmcgPSAoZGJTb25nOiBEYXRhYmFzZVNvbmcsIGlzTGlrZWQ6IGJvb2xlYW4gPSBmYWxzZSk6IFNvbmcgPT4gKHtcbiAgICBmaWxlX2lkOiBkYlNvbmcuZmlsZV9pZCxcbiAgICBpbWdfaWQ6IGRiU29uZy5pbWdfaWQsXG4gICAgbmFtZTogZGJTb25nLm5hbWUsXG4gICAgYXJ0aXN0OiBkYlNvbmcuYXJ0aXN0LFxuICAgIGxhbmd1YWdlOiBkYlNvbmcubGFuZ3VhZ2UsXG4gICAgdGFnczogZGJTb25nLnRhZ3MsXG4gICAgdmlld3M6IGRiU29uZy52aWV3cyxcbiAgICBsaWtlczogZGJTb25nLmxpa2VzLFxuICAgIGlkOiBkYlNvbmcuZmlsZV9pZC50b1N0cmluZygpLFxuICAgIGltYWdlOiBgaHR0cHM6Ly9pbWFnZXMucGV4ZWxzLmNvbS9waG90b3MvJHtkYlNvbmcuaW1nX2lkfS9wZXhlbHMtcGhvdG8tJHtkYlNvbmcuaW1nX2lkfS5qcGVnP2F1dG89Y29tcHJlc3MmY3M9dGlueXNyZ2Imdz0zMDBgLFxuICAgIGlzTGlrZWRcbiAgfSlcblxuICAvLyBGZXRjaCBhbGwgc29uZ3NcbiAgY29uc3QgZmV0Y2hTb25ncyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHNldFNvbmdzKFtdKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGE6IHNvbmdzRGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzb25ncycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAub3JkZXIoJ3ZpZXdzJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcblxuICAgICAgbGV0IHVzZXJMaWtlZFNvbmdzID0gbmV3IFNldDxudW1iZXI+KClcbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhOiBsaWtlZERhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdsaWtlZF9zb25ncycpXG4gICAgICAgIC5zZWxlY3QoJ3NvbmdfaWQnKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuICAgICAgXG4gICAgICBpZiAobGlrZWREYXRhKSB7XG4gICAgICAgIHVzZXJMaWtlZFNvbmdzID0gbmV3IFNldChsaWtlZERhdGEubWFwKGl0ZW0gPT4gaXRlbS5zb25nX2lkKSlcbiAgICAgICAgc2V0TGlrZWRTb25ncyh1c2VyTGlrZWRTb25ncylcbiAgICAgIH1cblxuICAgICAgY29uc3QgY29udmVydGVkU29uZ3MgPSBzb25nc0RhdGE/Lm1hcChzb25nID0+IFxuICAgICAgICBjb252ZXJ0RGF0YWJhc2VTb25nKHNvbmcsIHVzZXJMaWtlZFNvbmdzLmhhcyhzb25nLmZpbGVfaWQpKVxuICAgICAgKSB8fCBbXVxuXG4gICAgICBjb25zdCBzb3J0ZWRTb25ncyA9IFsuLi5jb252ZXJ0ZWRTb25nc10uc29ydCgoYSwgYikgPT4ge1xuICAgICAgICBjb25zdCBhU2NvcmUgPSBhLnZpZXdzICsgYS5saWtlcztcbiAgICAgICAgY29uc3QgYlNjb3JlID0gYi52aWV3cyArIGIubGlrZXM7XG4gICAgICAgIHJldHVybiBiU2NvcmUgLSBhU2NvcmU7XG4gICAgICB9KTtcblxuICAgICAgc2V0U29uZ3Moc29ydGVkU29uZ3MpO1xuXG4gICAgICBjb25zdCB7IGRhdGE6IHVzZXJEYXRhIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgICAuc2VsZWN0KCdsYXN0X3NvbmdfZmlsZV9pZCcpXG4gICAgICAgIC5lcSgnaWQnLCB1c2VyLmlkKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKHVzZXJEYXRhPy5sYXN0X3NvbmdfZmlsZV9pZCkge1xuICAgICAgICBjb25zdCBsYXN0U29uZyA9IGNvbnZlcnRlZFNvbmdzLmZpbmQoc29uZyA9PiBzb25nLmZpbGVfaWQgPT09IHVzZXJEYXRhLmxhc3Rfc29uZ19maWxlX2lkKVxuICAgICAgICBpZiAobGFzdFNvbmcpIHtcbiAgICAgICAgICBzZXRMYXN0UGxheWVkU29uZyhsYXN0U29uZylcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzb25nczonLCBlcnJvcilcbiAgICAgIHNldFNvbmdzKFtdKSAvLyBTZXQgZW1wdHkgYXJyYXkgb24gZXJyb3JcbiAgICB9XG4gIH1cblxuICAvLyBGZXRjaCB1c2VyIHBsYXlsaXN0c1xuICBjb25zdCBmZXRjaFBsYXlsaXN0cyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHNldFBsYXlsaXN0cyhbXSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGE6IHBsYXlsaXN0c0RhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGxheWxpc3RzJylcbiAgICAgICAgLnNlbGVjdChgXG4gICAgICAgICAgaWQsXG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBwbGF5bGlzdF9zb25ncyAoXG4gICAgICAgICAgICBzb25ncyAoKilcbiAgICAgICAgICApXG4gICAgICAgIGApXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpXG5cbiAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcblxuICAgICAgY29uc3QgY29udmVydGVkUGxheWxpc3RzOiBQbGF5bGlzdFtdID0gcGxheWxpc3RzRGF0YT8ubWFwKHBsYXlsaXN0ID0+IHtcbiAgICAgICAgY29uc3QgcGxheWxpc3RTb25ncyA9IHBsYXlsaXN0LnBsYXlsaXN0X3NvbmdzPy5tYXAoKHBzOiBhbnkpID0+IFxuICAgICAgICAgIGNvbnZlcnREYXRhYmFzZVNvbmcocHMuc29uZ3MsIGxpa2VkU29uZ3MuaGFzKHBzLnNvbmdzLmZpbGVfaWQpKVxuICAgICAgICApIHx8IFtdXG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogcGxheWxpc3QuaWQudG9TdHJpbmcoKSxcbiAgICAgICAgICBuYW1lOiBwbGF5bGlzdC5uYW1lLFxuICAgICAgICAgIHNvbmdDb3VudDogcGxheWxpc3RTb25ncy5sZW5ndGgsXG4gICAgICAgICAgaW1hZ2U6IHBsYXlsaXN0U29uZ3NbMF0/LmltYWdlIHx8ICdodHRwczovL2ltYWdlcy5wZXhlbHMuY29tL3Bob3Rvcy8xNzYzMDc1L3BleGVscy1waG90by0xNzYzMDc1LmpwZWc/YXV0bz1jb21wcmVzcyZjcz10aW55c3JnYiZ3PTMwMCcsXG4gICAgICAgICAgc29uZ3M6IHBsYXlsaXN0U29uZ3NcbiAgICAgICAgfVxuICAgICAgfSkgfHwgW11cblxuICAgICAgc2V0UGxheWxpc3RzKGNvbnZlcnRlZFBsYXlsaXN0cylcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcGxheWxpc3RzOicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIC8vIFRvZ2dsZSBsaWtlIHNvbmdcbiAgY29uc3QgdG9nZ2xlTGlrZSA9IGFzeW5jIChzb25nSWQ6IHN0cmluZykgPT4ge1xuICBpZiAoIXVzZXIpIHJldHVybjtcblxuICBjb25zdCBzb25nRmlsZUlkID0gcGFyc2VJbnQoc29uZ0lkKTtcbiAgY29uc3QgaXNDdXJyZW50bHlMaWtlZCA9IGxpa2VkU29uZ3MuaGFzKHNvbmdGaWxlSWQpO1xuXG4gIHRyeSB7XG4gICAgaWYgKGlzQ3VycmVudGx5TGlrZWQpIHtcbiAgICAgIC8vIFJlbW92ZSBmcm9tIGxpa2VkX3NvbmdzXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnbGlrZWRfc29uZ3MnKVxuICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgICAgLmVxKCdzb25nX2lkJywgc29uZ0ZpbGVJZCk7XG5cbiAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG5cbiAgICAgIC8vIERlY3JlbWVudCBsaWtlc1xuICAgICAgYXdhaXQgc3VwYWJhc2UucnBjKCdkZWNyZW1lbnRfc29uZ19saWtlcycsIHsgc29uZ19maWxlX2lkOiBzb25nRmlsZUlkIH0pO1xuXG4gICAgICBzZXRMaWtlZFNvbmdzKHByZXYgPT4ge1xuICAgICAgICBjb25zdCBuZXdTZXQgPSBuZXcgU2V0KHByZXYpO1xuICAgICAgICBuZXdTZXQuZGVsZXRlKHNvbmdGaWxlSWQpO1xuICAgICAgICByZXR1cm4gbmV3U2V0O1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEFkZCB0byBsaWtlZF9zb25nc1xuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2xpa2VkX3NvbmdzJylcbiAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgdXNlcl9pZDogdXNlci5pZCxcbiAgICAgICAgICBzb25nX2lkOiBzb25nRmlsZUlkLFxuICAgICAgICB9KTtcblxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcblxuICAgICAgLy8gSW5jcmVtZW50IGxpa2VzXG4gICAgICBhd2FpdCBzdXBhYmFzZS5ycGMoJ2luY3JlbWVudF9zb25nX2xpa2VzJywgeyBzb25nX2ZpbGVfaWQ6IHNvbmdGaWxlSWQgfSk7XG5cbiAgICAgIHNldExpa2VkU29uZ3MocHJldiA9PiBuZXcgU2V0KHByZXYpLmFkZChzb25nRmlsZUlkKSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHNvbmdzIHN0YXRlXG4gICAgLy8gVXBkYXRlIHNvbmdzIHN0YXRlXG5zZXRTb25ncyhwcmV2U29uZ3MgPT5cbiAgcHJldlNvbmdzLm1hcChzb25nID0+XG4gICAgc29uZy5pZCA9PT0gc29uZ0lkXG4gICAgICA/IHtcbiAgICAgICAgICAuLi5zb25nLFxuICAgICAgICAgIGlzTGlrZWQ6ICFpc0N1cnJlbnRseUxpa2VkLFxuICAgICAgICAgIGxpa2VzOiBzb25nLmxpa2VzICsgKGlzQ3VycmVudGx5TGlrZWQgPyAtMSA6IDEpLFxuICAgICAgICB9XG4gICAgICA6IHNvbmdcbiAgKVxuKTtcblxuXG4gICAgLy8gVXBkYXRlIHBsYXlsaXN0cyBzdGF0ZVxuICAgIHNldFBsYXlsaXN0cyhwcmV2UGxheWxpc3RzID0+XG4gICAgICBwcmV2UGxheWxpc3RzLm1hcChwbGF5bGlzdCA9PiAoe1xuICAgICAgICAuLi5wbGF5bGlzdCxcbiAgICAgICAgc29uZ3M6IHBsYXlsaXN0LnNvbmdzLm1hcChzb25nID0+XG4gICAgICAgICAgc29uZy5pZCA9PT0gc29uZ0lkXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAuLi5zb25nLFxuICAgICAgICAgICAgICAgIGlzTGlrZWQ6ICFpc0N1cnJlbnRseUxpa2VkLFxuICAgICAgICAgICAgICAgIGxpa2VzOiBzb25nLmxpa2VzICsgKGlzQ3VycmVudGx5TGlrZWQgPyAtMSA6IDEpLFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA6IHNvbmdcbiAgICAgICAgKSxcbiAgICAgIH0pKVxuICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdG9nZ2xpbmcgbGlrZTonLCBlcnJvcik7XG4gIH1cbn07XG5cblxuICAvLyBDcmVhdGUgcGxheWxpc3RcbiAgY29uc3QgY3JlYXRlUGxheWxpc3QgPSBhc3luYyAobmFtZTogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCF1c2VyKSByZXR1cm5cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGxheWxpc3RzJylcbiAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgdXNlcl9pZDogdXNlci5pZCxcbiAgICAgICAgICBuYW1lXG4gICAgICAgIH0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuXG4gICAgICBjb25zdCBuZXdQbGF5bGlzdDogUGxheWxpc3QgPSB7XG4gICAgICAgIGlkOiBkYXRhLmlkLnRvU3RyaW5nKCksXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgc29uZ0NvdW50OiAwLFxuICAgICAgICBpbWFnZTogJ2h0dHBzOi8vaW1hZ2VzLnBleGVscy5jb20vcGhvdG9zLzE3NjMwNzUvcGV4ZWxzLXBob3RvLTE3NjMwNzUuanBlZz9hdXRvPWNvbXByZXNzJmNzPXRpbnlzcmdiJnc9MzAwJyxcbiAgICAgICAgc29uZ3M6IFtdXG4gICAgICB9XG5cbiAgICAgIHNldFBsYXlsaXN0cyhwcmV2ID0+IFsuLi5wcmV2LCBuZXdQbGF5bGlzdF0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHBsYXlsaXN0OicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIC8vIERlbGV0ZSBwbGF5bGlzdFxuICBjb25zdCBkZWxldGVQbGF5bGlzdCA9IGFzeW5jIChwbGF5bGlzdElkOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoIXVzZXIpIHJldHVyblxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwbGF5bGlzdHMnKVxuICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgLmVxKCdpZCcsIHBhcnNlSW50KHBsYXlsaXN0SWQpKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG5cbiAgICAgIHNldFBsYXlsaXN0cyhwcmV2ID0+IHByZXYuZmlsdGVyKHBsYXlsaXN0ID0+IHBsYXlsaXN0LmlkICE9PSBwbGF5bGlzdElkKSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgcGxheWxpc3Q6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLy8gUmVuYW1lIHBsYXlsaXN0XG4gIGNvbnN0IHJlbmFtZVBsYXlsaXN0ID0gYXN5bmMgKHBsYXlsaXN0SWQ6IHN0cmluZywgbmV3TmFtZTogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCF1c2VyKSByZXR1cm5cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGxheWxpc3RzJylcbiAgICAgICAgLnVwZGF0ZSh7IG5hbWU6IG5ld05hbWUgfSlcbiAgICAgICAgLmVxKCdpZCcsIHBhcnNlSW50KHBsYXlsaXN0SWQpKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG5cbiAgICAgIHNldFBsYXlsaXN0cyhwcmV2ID0+IFxuICAgICAgICBwcmV2Lm1hcChwbGF5bGlzdCA9PiBcbiAgICAgICAgICBwbGF5bGlzdC5pZCA9PT0gcGxheWxpc3RJZCBcbiAgICAgICAgICAgID8geyAuLi5wbGF5bGlzdCwgbmFtZTogbmV3TmFtZSB9XG4gICAgICAgICAgICA6IHBsYXlsaXN0XG4gICAgICAgIClcbiAgICAgIClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVuYW1pbmcgcGxheWxpc3Q6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLy8gQWRkIHNvbmcgdG8gcGxheWxpc3RcbiAgY29uc3QgYWRkU29uZ1RvUGxheWxpc3QgPSBhc3luYyAocGxheWxpc3RJZDogc3RyaW5nLCBzb25nOiBTb25nKSA9PiB7XG4gICAgaWYgKCF1c2VyKSByZXR1cm5cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgncGxheWxpc3Rfc29uZ3MnKVxuICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICBwbGF5bGlzdF9pZDogcGFyc2VJbnQocGxheWxpc3RJZCksXG4gICAgICAgICAgc29uZ19pZDogc29uZy5maWxlX2lkXG4gICAgICAgIH0pXG5cbiAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcblxuICAgICAgc2V0UGxheWxpc3RzKHByZXYgPT4gXG4gICAgICAgIHByZXYubWFwKHBsYXlsaXN0ID0+IHtcbiAgICAgICAgICBpZiAocGxheWxpc3QuaWQgPT09IHBsYXlsaXN0SWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHNvbmdFeGlzdHMgPSBwbGF5bGlzdC5zb25ncy5zb21lKHMgPT4gcy5pZCA9PT0gc29uZy5pZClcbiAgICAgICAgICAgIGlmICghc29uZ0V4aXN0cykge1xuICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkU29uZ3MgPSBbLi4ucGxheWxpc3Quc29uZ3MsIHNvbmddXG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgLi4ucGxheWxpc3QsXG4gICAgICAgICAgICAgICAgc29uZ3M6IHVwZGF0ZWRTb25ncyxcbiAgICAgICAgICAgICAgICBzb25nQ291bnQ6IHVwZGF0ZWRTb25ncy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgaW1hZ2U6IHVwZGF0ZWRTb25nc1swXT8uaW1hZ2UgfHwgcGxheWxpc3QuaW1hZ2VcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcGxheWxpc3RcbiAgICAgICAgfSlcbiAgICAgIClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgYWRkaW5nIHNvbmcgdG8gcGxheWxpc3Q6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLy8gUmVtb3ZlIHNvbmcgZnJvbSBwbGF5bGlzdFxuICBjb25zdCByZW1vdmVTb25nRnJvbVBsYXlsaXN0ID0gYXN5bmMgKHBsYXlsaXN0SWQ6IHN0cmluZywgc29uZ0lkOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoIXVzZXIpIHJldHVyblxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdwbGF5bGlzdF9zb25ncycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ3BsYXlsaXN0X2lkJywgcGFyc2VJbnQocGxheWxpc3RJZCkpXG4gICAgICAgIC5lcSgnc29uZ19pZCcsIHBhcnNlSW50KHNvbmdJZCkpXG5cbiAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcblxuICAgICAgc2V0UGxheWxpc3RzKHByZXYgPT4gXG4gICAgICAgIHByZXYubWFwKHBsYXlsaXN0ID0+IHtcbiAgICAgICAgICBpZiAocGxheWxpc3QuaWQgPT09IHBsYXlsaXN0SWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRTb25ncyA9IHBsYXlsaXN0LnNvbmdzLmZpbHRlcihzb25nID0+IHNvbmcuaWQgIT09IHNvbmdJZClcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIC4uLnBsYXlsaXN0LFxuICAgICAgICAgICAgICBzb25nczogdXBkYXRlZFNvbmdzLFxuICAgICAgICAgICAgICBzb25nQ291bnQ6IHVwZGF0ZWRTb25ncy5sZW5ndGgsXG4gICAgICAgICAgICAgIGltYWdlOiB1cGRhdGVkU29uZ3NbMF0/LmltYWdlIHx8ICdodHRwczovL2ltYWdlcy5wZXhlbHMuY29tL3Bob3Rvcy8xNzYzMDc1L3BleGVscy1waG90by0xNzYzMDc1LmpwZWc/YXV0bz1jb21wcmVzcyZjcz10aW55c3JnYiZ3PTMwMCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHBsYXlsaXN0XG4gICAgICAgIH0pXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIHNvbmcgZnJvbSBwbGF5bGlzdDonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyBVcGRhdGUgbGFzdCBzb25nIGluIHVzZXIgcHJvZmlsZVxuICBjb25zdCB1cGRhdGVMYXN0U29uZyA9IGFzeW5jIChzb25nSWQ6IHN0cmluZykgPT4ge1xuICAgIGlmICghdXNlcikgcmV0dXJuXG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgICAgLnVwZGF0ZSh7IGxhc3Rfc29uZ19maWxlX2lkOiBwYXJzZUludChzb25nSWQpIH0pXG4gICAgICAgIC5lcSgnaWQnLCB1c2VyLmlkKVxuXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGxhc3Qgc29uZzonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyBSZWNvcmQgbGlzdGVuaW5nIGhpc3Rvcnkgd2l0aCBwcm9wZXIgdGltZSB0cmFja2luZ1xuICBjb25zdCByZWNvcmRMaXN0ZW5pbmdIaXN0b3J5ID0gYXN5bmMgKHNvbmdJZDogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCF1c2VyKSByZXR1cm5cblxuICAgIC8vIElmIHRoZXJlJ3MgYSBwcmV2aW91cyBzb25nIHBsYXlpbmcsIHJlY29yZCBpdHMgbGlzdGVuaW5nIHRpbWVcbiAgICAgIGlmIChjdXJyZW50U29uZ1JlZi5jdXJyZW50ICYmIGN1cnJlbnRTb25nU3RhcnRUaW1lKSB7XG4gICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgbWludXRlc0xpc3RlbmVkID0gKGVuZFRpbWUuZ2V0VGltZSgpIC0gY3VycmVudFNvbmdTdGFydFRpbWUuZ2V0VGltZSgpKSAvICgxMDAwICogNjApO1xuXG4gICAgaWYgKG1pbnV0ZXNMaXN0ZW5lZCA+IDAuMSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbWludXRlcyA9IE1hdGgucm91bmQobWludXRlc0xpc3RlbmVkICogMTAwKSAvIDEwMDtcbiAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKCd1cHNlcnRfaGlzdG9yeV9taW51dGVzJywge1xuICAgICAgICAgIHVzZXJfdXVpZDogdXNlci5pZCxcbiAgICAgICAgICBzb25nX2ZpbGVfaWQ6IHBhcnNlSW50KGN1cnJlbnRTb25nUmVmLmN1cnJlbnQpLFxuICAgICAgICAgIG1pbnV0ZXM6IG1pbnV0ZXMsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciByZWNvcmRpbmcgc29uZyBoaXN0b3J5OicsIGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIEhpc3RvcnkgdXBkYXRlZDogKyR7bWludXRlc30gbWlucyBmb3Igc29uZyAke2N1cnJlbnRTb25nUmVmLmN1cnJlbnR9YCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlY29yZGluZyBwcmV2aW91cyBzb25nIGhpc3Rvcnk6JywgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cbiAgICAvLyBTZXQgbmV3IHNvbmcgYXMgY3VycmVudFxuICAgIGN1cnJlbnRTb25nUmVmLmN1cnJlbnQgPSBzb25nSWRcbiAgICBzZXRDdXJyZW50U29uZ1N0YXJ0VGltZShuZXcgRGF0ZSgpKVxuICAgIFxuICAgIC8vIFVwZGF0ZSBsYXN0IHNvbmcgaW4gdXNlciBwcm9maWxlXG4gICAgYXdhaXQgdXBkYXRlTGFzdFNvbmcoc29uZ0lkKVxudHJ5IHtcbiAgYXdhaXQgc3VwYWJhc2UucnBjKCdpbmNyZW1lbnRfc29uZ192aWV3cycsIHsgc29uZ19maWxlX2lkOiBwYXJzZUludChzb25nSWQpIH0pO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgY29uc29sZS5lcnJvcignRXJyb3IgaW5jcmVtZW50aW5nIHNvbmcgdmlld3M6JywgZXJyb3IpO1xufVxuXG4gIH1cblxuICAvLyBTdG9wIGN1cnJlbnQgc29uZyB0cmFja2luZyAod2hlbiBwbGF5ZXIgaXMgY2xvc2VkKVxuICBjb25zdCBzdG9wQ3VycmVudFNvbmdUcmFja2luZyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoY3VycmVudFNvbmdSZWYuY3VycmVudCAmJiBjdXJyZW50U29uZ1N0YXJ0VGltZSAmJiB1c2VyKSB7XG4gICAgICBjb25zdCBlbmRUaW1lID0gbmV3IERhdGUoKVxuICAgICAgY29uc3QgbWludXRlc0xpc3RlbmVkID0gKGVuZFRpbWUuZ2V0VGltZSgpIC0gY3VycmVudFNvbmdTdGFydFRpbWUuZ2V0VGltZSgpKSAvICgxMDAwICogNjApXG4gICAgICBcbiAgICAgIGlmIChtaW51dGVzTGlzdGVuZWQgPiAwLjEpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBtaW51dGVzID0gTWF0aC5yb3VuZChtaW51dGVzTGlzdGVuZWQgKiAxMDApIC8gMTAwO1xuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYygndXBzZXJ0X2hpc3RvcnlfbWludXRlcycsIHtcbiAgICAgIHVzZXJfdXVpZDogdXNlci5pZCxcbiAgICAgIHNvbmdfZmlsZV9pZDogcGFyc2VJbnQoY3VycmVudFNvbmdSZWYuY3VycmVudCksXG4gICAgICBtaW51dGVzOiBtaW51dGVzLFxuICAgIH0pO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgcmVjb3JkaW5nIHNvbmcgaGlzdG9yeSBvbiBzdG9wOicsIGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coYPCfm5EgSGlzdG9yeSB1cGRhdGVkIG9uIHN0b3A6ICske21pbnV0ZXN9IG1pbnMgZm9yIHNvbmcgJHtjdXJyZW50U29uZ1JlZi5jdXJyZW50fWApO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNvcmRpbmcgZmluYWwgc29uZyBoaXN0b3J5OicsIGVycm9yKTtcbiAgfVxufVxuXG4gICAgfVxuXG4gICAgY3VycmVudFNvbmdSZWYuY3VycmVudCA9IG51bGxcbiAgICBzZXRDdXJyZW50U29uZ1N0YXJ0VGltZShudWxsKVxuICB9XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBsb2FkRGF0YSA9IGFzeW5jICgpID0+IHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSlcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFtmZXRjaFNvbmdzKCksIGZldGNoUGxheWxpc3RzKCldKVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyBkYXRhOicsIGVycm9yKVxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgc2V0TG9hZGluZyhmYWxzZSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodXNlcikge1xuICAgICAgbG9hZERhdGEoKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZXNldCBkYXRhIHdoZW4gdXNlciBsb2dzIG91dFxuICAgICAgc2V0U29uZ3MoW10pXG4gICAgICBzZXRQbGF5bGlzdHMoW10pXG4gICAgICBzZXRMaWtlZFNvbmdzKG5ldyBTZXQoKSlcbiAgICAgIHNldExhc3RQbGF5ZWRTb25nKG51bGwpXG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKVxuICAgIH1cbiAgfSwgW3VzZXJdKVxuXG4gIHJldHVybiB7XG4gICAgc29uZ3MsXG4gICAgcGxheWxpc3RzLFxuICAgIGxpa2VkU29uZ3M6IHNvbmdzLmZpbHRlcihzb25nID0+IHNvbmcuaXNMaWtlZCksXG4gICAgbGFzdFBsYXllZFNvbmcsXG4gICAgbG9hZGluZyxcbiAgICB0b2dnbGVMaWtlLFxuICAgIGNyZWF0ZVBsYXlsaXN0LFxuICAgIGRlbGV0ZVBsYXlsaXN0LFxuICAgIHJlbmFtZVBsYXlsaXN0LFxuICAgIGFkZFNvbmdUb1BsYXlsaXN0LFxuICAgIHJlbW92ZVNvbmdGcm9tUGxheWxpc3QsXG4gICAgcmVjb3JkTGlzdGVuaW5nSGlzdG9yeSxcbiAgICBzdG9wQ3VycmVudFNvbmdUcmFja2luZyxcbiAgICByZWZyZXNoRGF0YTogKCkgPT4ge1xuICAgICAgZmV0Y2hTb25ncygpXG4gICAgICBmZXRjaFBsYXlsaXN0cygpXG4gICAgfVxuICB9XG59Il0sIm5hbWVzIjpbInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlUmVmIiwic3VwYWJhc2UiLCJ1c2VTdXBhYmFzZURhdGEiLCJ1c2VyIiwic29uZ3MiLCJzZXRTb25ncyIsInBsYXlsaXN0cyIsInNldFBsYXlsaXN0cyIsImxpa2VkU29uZ3MiLCJzZXRMaWtlZFNvbmdzIiwiU2V0IiwibGFzdFBsYXllZFNvbmciLCJzZXRMYXN0UGxheWVkU29uZyIsImxvYWRpbmciLCJzZXRMb2FkaW5nIiwiY3VycmVudFNvbmdTdGFydFRpbWUiLCJzZXRDdXJyZW50U29uZ1N0YXJ0VGltZSIsImN1cnJlbnRTb25nUmVmIiwiY29udmVydERhdGFiYXNlU29uZyIsImRiU29uZyIsImlzTGlrZWQiLCJmaWxlX2lkIiwiaW1nX2lkIiwibmFtZSIsImFydGlzdCIsImxhbmd1YWdlIiwidGFncyIsInZpZXdzIiwibGlrZXMiLCJpZCIsInRvU3RyaW5nIiwiaW1hZ2UiLCJmZXRjaFNvbmdzIiwiZGF0YSIsInNvbmdzRGF0YSIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwidXNlckxpa2VkU29uZ3MiLCJsaWtlZERhdGEiLCJlcSIsIm1hcCIsIml0ZW0iLCJzb25nX2lkIiwiY29udmVydGVkU29uZ3MiLCJzb25nIiwiaGFzIiwic29ydGVkU29uZ3MiLCJzb3J0IiwiYSIsImIiLCJhU2NvcmUiLCJiU2NvcmUiLCJ1c2VyRGF0YSIsInNpbmdsZSIsImxhc3Rfc29uZ19maWxlX2lkIiwibGFzdFNvbmciLCJmaW5kIiwiY29uc29sZSIsImZldGNoUGxheWxpc3RzIiwicGxheWxpc3RzRGF0YSIsImNvbnZlcnRlZFBsYXlsaXN0cyIsInBsYXlsaXN0IiwicGxheWxpc3RTb25ncyIsInBsYXlsaXN0X3NvbmdzIiwicHMiLCJzb25nQ291bnQiLCJsZW5ndGgiLCJ0b2dnbGVMaWtlIiwic29uZ0lkIiwic29uZ0ZpbGVJZCIsInBhcnNlSW50IiwiaXNDdXJyZW50bHlMaWtlZCIsImRlbGV0ZSIsInJwYyIsInNvbmdfZmlsZV9pZCIsInByZXYiLCJuZXdTZXQiLCJpbnNlcnQiLCJ1c2VyX2lkIiwiYWRkIiwicHJldlNvbmdzIiwicHJldlBsYXlsaXN0cyIsImNyZWF0ZVBsYXlsaXN0IiwibmV3UGxheWxpc3QiLCJkZWxldGVQbGF5bGlzdCIsInBsYXlsaXN0SWQiLCJmaWx0ZXIiLCJyZW5hbWVQbGF5bGlzdCIsIm5ld05hbWUiLCJ1cGRhdGUiLCJhZGRTb25nVG9QbGF5bGlzdCIsInBsYXlsaXN0X2lkIiwic29uZ0V4aXN0cyIsInNvbWUiLCJzIiwidXBkYXRlZFNvbmdzIiwicmVtb3ZlU29uZ0Zyb21QbGF5bGlzdCIsInVwZGF0ZUxhc3RTb25nIiwicmVjb3JkTGlzdGVuaW5nSGlzdG9yeSIsImN1cnJlbnQiLCJlbmRUaW1lIiwiRGF0ZSIsIm1pbnV0ZXNMaXN0ZW5lZCIsImdldFRpbWUiLCJtaW51dGVzIiwiTWF0aCIsInJvdW5kIiwidXNlcl91dWlkIiwibG9nIiwic3RvcEN1cnJlbnRTb25nVHJhY2tpbmciLCJsb2FkRGF0YSIsIlByb21pc2UiLCJhbGwiLCJyZWZyZXNoRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./hooks/useSupabaseData.ts\n"));

/***/ })

});